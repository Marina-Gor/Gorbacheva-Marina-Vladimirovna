/*! For license information please see filenamea9ae1ae289f53fee1f9e.js.LICENSE.txt */
(()=>{"use strict";var t={151:(t,e,n)=>{n.d(e,{Z:()=>w});var i=n(81),s=n.n(i),r=n(645),o=n.n(r),a=n(637),c=n(667),l=n.n(c),h=new URL(n(722),n.b),d=new URL(n(474),n.b),u=new URL(n(455),n.b),p=new URL(n(531),n.b),f=o()(s());f.i(a.Z),f.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=Bangers&display=swap);"]);var g=l()(h),m=l()(d),v=l()(u),y=l()(p);f.push([t.id,`@font-face{font-family:"Kashmir";src:url(${g}) format("truetype")}html{box-sizing:border-box;outline:none;margin:0;padding:0}*,*::before,*::after{box-sizing:inherit}body{font-family:"Bangers",system-ui;font-size:24px;background-color:#272727;background-image:url(${m});background-position:center center;background-repeat:no-repeat;background-size:cover;overflow:hidden;width:100%;height:100vh}.hidden{display:none}.show{display:block}.app .header{display:flex;justify-content:center}.app .header-logo{width:450px;height:150px}.app .main{height:100%;display:flex;align-items:center;flex-direction:column;width:auto;height:auto;position:relative}.app .main-menu{width:100%;text-align:end}.app .main-menu .menu-list{display:flex;justify-content:center;align-items:center;flex-direction:row;flex-wrap:wrap}.app .main-menu .menu-list .menu-link{text-decoration:none;display:inline-block;padding:10px 10px;height:50px;border-radius:10px;box-shadow:0 0 40px 40px #3c342e inset,0 0 0 0 #3c342e;font-family:"Kashmir",sans-serif;font-weight:bold;text-align:center;letter-spacing:2px;color:#fcd54c;transition:.15s ease-in-out;width:140px;margin:10px;height:auto;font-size:28px}.app .main-menu .menu-list .menu-link:hover{background:#fcd54c;box-shadow:0 0 10px 0 #3c342e inset,0 0 10px 4px #3c342e;color:#3c342e;transform:translateY(-10px)}.app .main-menu .menu-list .menu-link:active{background:#fcd54c;box-shadow:none}.app .main .content .main-title{padding:10px;text-align:center;font-size:28px}.app .main .content .rules{width:500px;max-width:100%;height:400px;max-height:100%;padding:10px;border-radius:25px;box-shadow:0 0 60px 10px rgba(0,0,0,.8)}.app .main .content .rules-title{text-align:center;font-size:28px}.app .main .content .rules-text{text-align:center;margin-top:30px}.app .main .content .records{width:500px;max-width:100%;height:400px;max-height:100%;padding:10px;border-radius:25px;box-shadow:0 0 60px 10px rgba(0,0,0,.8)}.app .main .content .records-title{text-align:center;font-size:28px}.app .main .content .error-text{text-align:center}.app .main .content .error a{color:#fcd54c}.app .main .content .game .game-field{display:flex;justify-content:space-between}.app .main #sound{width:20px;height:20px;background-color:rgba(0,0,0,0);border:none}.app .main .sound-off{background-image:url(${v})}.app .main .sound-on{background-image:url(${y})}.app .login{width:100vw;height:100vh;background-color:rgba(60,52,46,.9);z-index:15}.app .login-form{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);text-align:center;width:400px;height:300px;padding:20px;border:2px solid #fcd54c;border-radius:30px;box-shadow:0 0 60px 10px rgba(252,213,76,.8);display:flex;flex-direction:column;justify-content:space-between;align-items:center}.app .login-form .item{padding:10px}.app .login-form .item .input-login{padding:4px;background:#fcd54c;margin-top:10px;width:100%;border:none;border-radius:10px;opacity:.5}.app .login-form button{text-decoration:none;display:inline-block;padding:5px 10px;height:50px;border-radius:10px;box-shadow:0 0 40px 40px #3c342e inset,0 0 0 0 #3c342e;font-family:"Kashmir",sans-serif;font-weight:bold;text-align:center;letter-spacing:2px;color:#fcd54c;transition:.15s ease-in-out;width:150px;margin:10px;height:auto;font-size:24px;cursor:pointer}.app .login-form button:hover{background:#fcd54c;box-shadow:0 0 10px 0 #3c342e inset,0 0 10px 4px #3c342e;color:#3c342e;transform:translateY(-10px)}.app .login-form button:active{background:#fcd54c;box-shadow:none}.app .login-form .errorlabel{font-size:12px;color:#fcd54c;width:100%;padding:4px;border:none;border-radius:0}canvas{width:auto;height:auto}.game__field{width:auto;height:auto}`,""]);const w=f},637:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(81),s=n.n(i),r=n(645),o=n.n(r)()(s());o.push([t.id,"/* http://meyerweb.com/eric/tools/css/reset/ \n   v2.0 | 20110126\n   License: none (public domain)\n*/\n\nhtml,\nbody,\ndiv,\nspan,\napplet,\nobject,\niframe,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\np,\nblockquote,\npre,\na,\nabbr,\nacronym,\naddress,\nbig,\ncite,\ncode,\ndel,\ndfn,\nem,\nimg,\nins,\nkbd,\nq,\ns,\nsamp,\nsmall,\nstrike,\nstrong,\nsub,\nsup,\ntt,\nvar,\nb,\nu,\ni,\ncenter,\ndl,\ndt,\ndd,\nol,\nul,\nli,\nfieldset,\nform,\nlabel,\nlegend,\ntable,\ncaption,\ntbody,\ntfoot,\nthead,\ntr,\nth,\ntd,\narticle,\naside,\ncanvas,\ndetails,\nembed,\nfigure,\nfigcaption,\nfooter,\nheader,\nhgroup,\nmenu,\nnav,\noutput,\nruby,\nsection,\nsummary,\ntime,\nmark,\naudio,\nvideo {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tvertical-align: baseline;\n}\n\n/* HTML5 display-role reset for older browsers */\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nhgroup,\nmenu,\nnav,\nsection {\n\tdisplay: block;\n}\n\nbody {\n\tline-height: 1;\n}\n\nol,\nul {\n\tlist-style: none;\n}\n\nblockquote,\nq {\n\tquotes: none;\n}\n\nblockquote:before,\nblockquote:after,\nq:before,\nq:after {\n\tcontent: '';\n\tcontent: none;\n}\n\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}",""]);const a=o},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&o[h[0]]||(void 0!==r&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=r),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),s&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=s):h[4]="".concat(s)),e.push(h))}},e}},667:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var c=t[a],l=i.base?c[0]+i.base:c[0],h=r[l]||0,d="".concat(l," ").concat(h);r[l]=h+1;var u=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var f=s(p,i);i.byIndex=a,e.splice(a,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var r=i(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=n(r[o]);e[a].references--}for(var c=i(t,s),l=0;l<r.length;l++){var h=n(r[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}r=c}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},722:(t,e,n)=>{t.exports=n.p+"KASHMIR.TTF"},474:(t,e,n)=>{t.exports=n.p+"bac.png"},455:(t,e,n)=>{t.exports=n.p+"offSound.png"},531:(t,e,n)=>{t.exports=n.p+"onSound.png"}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,n),r.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var s=i.length-1;s>-1&&!t;)t=i[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{var t=n(379),e=n.n(t),i=n(795),s=n.n(i),r=n(569),o=n.n(r),a=n(565),c=n.n(a),l=n(216),h=n.n(l),d=n(589),u=n.n(d),p=n(151),f={};f.styleTagTransform=u(),f.setAttributes=c(),f.insert=o().bind(null,"head"),f.domAPI=s(),f.insertStyleElement=h(),e()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals;const g=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},m={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=s>>2,h=(3&s)<<4|o>>4;let d=(15&o)<<2|c>>6,u=63&c;a||(u=64,r||(d=64)),i.push(n[l],n[h],n[d],n[u])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(g(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==o||null==a)throw new v;const c=s<<2|r>>4;if(i.push(c),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class v extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const y=function(t){return function(t){const e=g(t);return m.encodeByteArray(e,!0)}(t).replace(/\./g,"")},w=function(t){try{return m.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},b=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&w(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},I=()=>{var t;return null===(t=b())||void 0===t?void 0:t.config},_=t=>{var e;return null===(e=b())||void 0===e?void 0:e[`_${t}`]};class T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function S(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function E(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function k(){try{return"object"==typeof indexedDB}catch(t){return!1}}function C(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class R extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,R.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,x.prototype.create)}}class x{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(P,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new R(i,o,n)}}const P=/\{\$([^}]+)}/g;function A(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(O(n)&&O(r)){if(!A(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function O(t){return null!==t&&"object"==typeof t}function N(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function L(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function D(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class M{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=U),void 0===i.error&&(i.error=U),void 0===i.complete&&(i.complete=U);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function U(){}const B=1e3,F=2,j=144e5,H=.5;function $(t,e=B,n=F){const i=e*Math.pow(n,t),s=Math.round(H*i*(Math.random()-.5)*2);return Math.min(j,i+s)}function V(t){return t&&t._delegate?t._delegate:t}class W{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const z="[DEFAULT]";class q{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new T;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:z})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=z){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=z){return this.instances.has(t)}getOptions(t=z){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===z?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=z){return this.component?this.component.multipleInstances?t:z:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class K{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new q(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const G=[];var J;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(J||(J={}));const Y={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},X=J.INFO,Z={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},Q=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=Z[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class tt{constructor(t){this.name=t,this._logLevel=X,this._logHandler=Q,this._userLogHandler=null,G.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in J))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?Y[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...t),this._logHandler(this,J.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...t),this._logHandler(this,J.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,J.INFO,...t),this._logHandler(this,J.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,J.WARN,...t),this._logHandler(this,J.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...t),this._logHandler(this,J.ERROR,...t)}}const et=(t,e)=>e.some((e=>t instanceof e));let nt,it;const st=new WeakMap,rt=new WeakMap,ot=new WeakMap,at=new WeakMap,ct=new WeakMap;let lt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return rt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ot.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ht(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(it||(it=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ut(this),t),dt(st.get(this))}:function(...t){return dt(e.apply(ut(this),t))}:function(t,...n){const i=e.call(ut(this),t,...n);return ot.set(i,t.sort?t.sort():[t]),dt(i)}:(t instanceof IDBTransaction&&function(t){if(rt.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));rt.set(t,e)}(t),et(t,nt||(nt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,lt):t);var e}function dt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(dt(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&st.set(e,t)})).catch((()=>{})),ct.set(e,t),e}(t);if(at.has(t))return at.get(t);const e=ht(t);return e!==t&&(at.set(t,e),ct.set(e,t)),e}const ut=t=>ct.get(t);function pt(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=dt(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(dt(o.result),t.oldVersion,t.newVersion,dt(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}const ft=["get","getKey","getAll","getAllKeys","count"],gt=["put","add","delete","clear"],mt=new Map;function vt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(mt.get(e))return mt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=gt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!ft.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return mt.set(e,r),r}var yt;yt=lt,lt={...yt,get:(t,e,n)=>vt(t,e)||yt.get(t,e,n),has:(t,e)=>!!vt(t,e)||yt.has(t,e)};class wt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const bt="@firebase/app",It="0.9.27",_t=new tt("@firebase/app"),Tt="[DEFAULT]",St={[bt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Et=new Map,kt=new Map;function Ct(t,e){try{t.container.addComponent(e)}catch(n){_t.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Rt(t){const e=t.name;if(kt.has(e))return _t.debug(`There were multiple attempts to register component ${e}.`),!1;kt.set(e,t);for(const e of Et.values())Ct(e,t);return!0}function xt(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const Pt=new x("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class At{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new W("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Pt.create("app-deleted",{appName:this._name})}}const Ot="10.8.0";function Nt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:Tt,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw Pt.create("bad-app-name",{appName:String(s)});if(n||(n=I()),!n)throw Pt.create("no-options");const r=Et.get(s);if(r){if(A(n,r.options)&&A(i,r.config))return r;throw Pt.create("duplicate-app",{appName:s})}const o=new K(s);for(const t of kt.values())o.addComponent(t);const a=new At(n,i,o);return Et.set(s,a),a}function Lt(t=Tt){const e=Et.get(t);if(!e&&t===Tt&&I())return Nt();if(!e)throw Pt.create("no-app",{appName:t});return e}function Dt(t,e,n){var i;let s=null!==(i=St[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void _t.warn(t.join(" "))}Rt(new W(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const Mt="firebase-heartbeat-database",Ut=1,Bt="firebase-heartbeat-store";let Ft=null;function jt(){return Ft||(Ft=pt(Mt,Ut,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Bt)}catch(t){console.warn(t)}}}).catch((t=>{throw Pt.create("idb-open",{originalErrorMessage:t.message})}))),Ft}async function Ht(t,e){try{const n=(await jt()).transaction(Bt,"readwrite"),i=n.objectStore(Bt);await i.put(e,$t(t)),await n.done}catch(t){if(t instanceof R)_t.warn(t.message);else{const e=Pt.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});_t.warn(e.message)}}}function $t(t){return`${t.name}!${t.options.appId}`}class Vt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new zt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Wt();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Wt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),qt(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),qt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=y(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Wt(){return(new Date).toISOString().substring(0,10)}class zt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!k()&&C().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await jt()).transaction(Bt),n=await e.objectStore(Bt).get($t(t));return await e.done,n}catch(t){if(t instanceof R)_t.warn(t.message);else{const e=Pt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});_t.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ht(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ht(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function qt(t){return y(JSON.stringify({version:2,heartbeats:t})).length}Rt(new W("platform-logger",(t=>new wt(t)),"PRIVATE")),Rt(new W("heartbeat",(t=>new Vt(t)),"PRIVATE")),Dt(bt,It,""),Dt(bt,It,"esm2017"),Dt("fire-js",""),Dt("firebase","10.8.0","app");const Kt="@firebase/installations",Gt="0.6.5",Jt=1e4,Yt=`w:${Gt}`,Xt="FIS_v2",Zt="https://firebaseinstallations.googleapis.com/v1",Qt=36e5,te=new x("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ee(t){return t instanceof R&&t.code.includes("request-failed")}function ne({projectId:t}){return`${Zt}/projects/${t}/installations`}function ie(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function se(t,e){const n=(await e.json()).error;return te.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function re({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function oe(t){const e=await t();return e.status>=500&&e.status<600?t():e}function ae(t){return new Promise((e=>{setTimeout(e,t)}))}const ce=/^[cdef][\w-]{21}$/,le="";function he(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return ce.test(e)?e:le}catch(t){return le}}function de(t){return`${t.appName}!${t.appId}`}const ue=new Map;function pe(t,e){const n=de(t);fe(n,e),function(t,e){const n=(!ge&&"BroadcastChannel"in self&&(ge=new BroadcastChannel("[Firebase] FID Change"),ge.onmessage=t=>{fe(t.data.key,t.data.fid)}),ge);n&&n.postMessage({key:t,fid:e}),0===ue.size&&ge&&(ge.close(),ge=null)}(n,e)}function fe(t,e){const n=ue.get(t);if(n)for(const t of n)t(e)}let ge=null;const me="firebase-installations-database",ve=1,ye="firebase-installations-store";let we=null;function be(){return we||(we=pt(me,ve,{upgrade:(t,e)=>{0===e&&t.createObjectStore(ye)}})),we}async function Ie(t,e){const n=de(t),i=(await be()).transaction(ye,"readwrite"),s=i.objectStore(ye),r=await s.get(n);return await s.put(e,n),await i.done,r&&r.fid===e.fid||pe(t,e.fid),e}async function _e(t){const e=de(t),n=(await be()).transaction(ye,"readwrite");await n.objectStore(ye).delete(e),await n.done}async function Te(t,e){const n=de(t),i=(await be()).transaction(ye,"readwrite"),s=i.objectStore(ye),r=await s.get(n),o=e(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||pe(t,o.fid),o}async function Se(t){let e;const n=await Te(t.appConfig,(n=>{const i=function(t){return Ce(t||{fid:he(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(te.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=ne(t),s=re(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:Xt,appId:t.appId,sdkVersion:Yt},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await oe((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:ie(t.authToken)}}throw await se("Create Installation",c)}(t,e);return Ie(t.appConfig,n)}catch(n){throw ee(n)&&409===n.customData.serverCode?await _e(t.appConfig):await Ie(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Ee(t)}:{installationEntry:e}}(t,i);return e=s.registrationPromise,s.installationEntry}));return n.fid===le?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Ee(t){let e=await ke(t.appConfig);for(;1===e.registrationStatus;)await ae(100),e=await ke(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Se(t);return n||e}return e}function ke(t){return Te(t,(t=>{if(!t)throw te.create("installation-not-found");return Ce(t)}))}function Ce(t){return 1===(e=t).registrationStatus&&e.registrationTime+Jt<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Re({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${ne(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=re(t);return n.append("Authorization",function(t){return`${Xt} ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:Yt,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await oe((()=>fetch(i,a)));if(c.ok)return ie(await c.json());throw await se("Generate Auth Token",c)}async function xe(t,e=!1){let n;const i=await Te(t.appConfig,(i=>{if(!Ae(i))throw te.create("not-registered");const s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Qt}(r)))return i;var r;if(1===s.requestStatus)return n=async function(t,e){let n=await Pe(t.appConfig);for(;1===n.authToken.requestStatus;)await ae(100),n=await Pe(t.appConfig);const i=n.authToken;return 0===i.requestStatus?xe(t,e):i}(t,e),i;{if(!navigator.onLine)throw te.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await Re(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Ie(t.appConfig,i),n}catch(n){if(!ee(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ie(t.appConfig,n)}else await _e(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function Pe(t){return Te(t,(t=>{if(!Ae(t))throw te.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Jt<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Ae(t){return void 0!==t&&2===t.registrationStatus}function Oe(t){return te.create("missing-app-config-values",{valueName:t})}const Ne="installations";Rt(new W(Ne,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw Oe("App Configuration");if(!t.name)throw Oe("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Oe(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:xt(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),Rt(new W("installations-internal",(t=>{const e=xt(t.getProvider("app").getImmediate(),Ne).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await Se(e);return i?i.catch(console.error):xe(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Se(t);e&&await e}(n),(await xe(n,e)).token}(e,t)}}),"PRIVATE")),Dt(Kt,Gt),Dt(Kt,Gt,"esm2017");const Le="analytics",De="firebase_id",Me="origin",Ue=6e4,Be="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Fe="https://www.googletagmanager.com/gtag/js",je=new tt("@firebase/analytics"),He=new x("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function $e(t){if(!t.startsWith(Fe)){const e=He.create("invalid-gtag-resource",{gtagURL:t});return je.warn(e.message),""}return t}function Ve(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const We=30,ze=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function qe(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Ke(t,e=ze,n){const{appId:i,apiKey:s,measurementId:r}=t.options;if(!i)throw He.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw He.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Je;return setTimeout((async()=>{a.abort()}),void 0!==n?n:Ue),Ge({appId:i,apiKey:s,measurementId:r},o,a,e)}async function Ge(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=ze){var r;const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(n,s);t.addEventListener((()=>{clearTimeout(r),i(He.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(a)return je.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,s={method:"GET",headers:qe(i)},r=Be.replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw He.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return s.deleteThrottleMetadata(o),e}catch(e){const c=e;if(!function(t){if(!(t instanceof R&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(s.deleteThrottleMetadata(o),a)return je.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw e}const l=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?$(n,s.intervalMillis,We):$(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return s.setThrottleMetadata(o,h),je.debug(`Calling attemptFetch again in ${l} millis`),Ge(t,h,i,s)}}class Je{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let Ye,Xe;async function Ze(t,e,n,i,s,r,o){var a;const c=Ke(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&je.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>je.error(t))),e.push(c);const l=async function(){if(!k())return je.warn(He.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await C()}catch(t){return je.warn(He.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[h,d]=await Promise.all([c,l]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Fe)&&n.src.includes(t))return n;return null})(r)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:$e}),i=document.createElement("script"),s=`${Fe}?l=${t}&id=${e}`;i.src=n?null==n?void 0:n.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(r,h.measurementId),Xe&&(s("consent","default",Xe),Xe=void 0),s("js",new Date);const u=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return u[Me]="firebase",u.update=!0,null!=d&&(u[De]=d),s("config",h.measurementId,u),Ye&&(s("set",Ye),Ye=void 0),h.measurementId}class Qe{constructor(t){this.app=t}_delete(){return delete tn[this.app.options.appId],Promise.resolve()}}let tn={},en=[];const nn={};let sn,rn,on="dataLayer",an=!1;function cn(t,e,n){!function(){const t=[];if(E()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=He.create("invalid-analytics-context",{errorInfo:e});je.warn(n.message)}}();const i=t.options.appId;if(!i)throw He.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw He.create("no-api-key");je.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=tn[i])throw He.create("already-exists",{id:i});if(!an){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(on);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,s){let r=function(...t){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(r=window[s]),window[s]=function(t,e,n,i){return async function(s,...r){try{if("event"===s){const[i,s]=r;await async function(t,e,n,i,s){try{let r=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const i=await Ve(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),s=t&&e[t.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",i,s||{})}catch(t){je.error(t)}}(t,e,n,i,s)}else if("config"===s){const[s,o]=r;await async function(t,e,n,i,s,r){const o=i[s];try{if(o)await e[o];else{const t=(await Ve(n)).find((t=>t.measurementId===s));t&&await e[t.appId]}}catch(t){je.error(t)}t("config",s,r)}(t,e,n,i,s,o)}else if("consent"===s){const[e]=r;t("consent","update",e)}else if("get"===s){const[e,n,i]=r;t("get",e,n,i)}else if("set"===s){const[e]=r;t("set",e)}else t(s,...r)}catch(t){je.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window[s]}}(tn,en,nn,on,"gtag");rn=t,sn=e,an=!0}return tn[i]=Ze(t,en,nn,e,sn,on,n),new Qe(t)}const ln="@firebase/analytics",hn="0.10.1";function dn(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}Rt(new W(Le,((t,{options:e})=>cn(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),Rt(new W("analytics-internal",(function(t){try{const e=t.getProvider(Le).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=V(t),async function(t,e,n,i,s){if(s&&s.global)t("event",n,i);else{const s=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(rn,tn[t.app.options.appId],e,n,i).catch((t=>je.error(t)))}(e,t,n,i)}}catch(t){throw He.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Dt(ln,hn),Dt(ln,hn,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const un=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},pn=new x("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fn=new tt("@firebase/auth");function gn(t,...e){fn.logLevel<=J.ERROR&&fn.error(`Auth (${Ot}): ${t}`,...e)}function mn(t,...e){throw yn(t,...e)}function vn(t,...e){return yn(t,...e)}function yn(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return pn.create(t,...e)}function wn(t,e,...n){if(!t)throw yn(e,...n)}function bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gn(e),new Error(e)}function In(t,e){t||bn(e)}function _n(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Tn(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class Sn{constructor(t,e){this.shortDelay=t,this.longDelay=e,In(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(S())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Tn()||"https:"===Tn()||E()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function En(t,e){In(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class kn{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Cn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Rn=new Sn(3e4,6e4);function xn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Pn(t,e,n,i,s={}){return An(t,s,(async()=>{let s={},r={};i&&("GET"===e?r=i:s={body:JSON.stringify(i)});const o=N(Object.assign({key:t.config.apiKey},r)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),kn.fetch()(Nn(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},s))}))}async function An(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Cn),e);try{const e=new Dn(t),s=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw Mn(t,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const e=s.ok?r.errorMessage:r.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Mn(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw Mn(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw Mn(t,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},un()),{[e]:n});return new x("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);mn(t,a)}}catch(e){if(e instanceof R)throw e;mn(t,"network-request-failed",{message:String(e)})}}async function On(t,e,n,i,s={}){const r=await Pn(t,e,n,i,s);return"mfaPendingCredential"in r&&mn(t,"multi-factor-auth-required",{_serverResponse:r}),r}function Nn(t,e,n,i){const s=`${e}${n}?${i}`;return t.config.emulator?En(t.config,s):`${t.config.apiScheme}://${s}`}function Ln(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Dn{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(vn(this.auth,"network-request-failed"))),Rn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Mn(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=vn(t,e,i);return s.customData._tokenResponse=n,s}function Un(t){return void 0!==t&&void 0!==t.enterprise}class Bn{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return Ln(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function Fn(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function jn(t){return 1e3*Number(t)}function Hn(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return gn("JWT malformed, contained fewer than 3 sections"),null;try{const t=w(n);return t?JSON.parse(t):(gn("Failed to decode base64 JWT payload"),null)}catch(t){return gn("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function $n(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof R&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Vn{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class Wn{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fn(this.lastLoginAt),this.creationTime=Fn(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function zn(t){var e;const n=t.auth,i=await t.getIdToken(),s=await $n(t,async function(t,e){return Pn(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));wn(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=(null===(e=r.providerUserInfo)||void 0===e?void 0:e.length)?r.providerUserInfo.map((t=>{var{providerId:e}=t,n=dn(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const h=t.isAnonymous,d=!(t.email&&r.passwordHash||(null==a?void 0:a.length)),u=!!h&&d,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Wn(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(t,p)}class qn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){wn(t.idToken,"internal-error"),wn(void 0!==t.idToken,"internal-error"),wn(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Hn(t);return wn(e,"internal-error"),wn(void 0!==e.exp,"internal-error"),wn(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return wn(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(t,e){const n=await An(t,{},(async()=>{const n=N({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,r=Nn(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",kn.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new qn;return n&&(wn("string"==typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(wn("string"==typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(wn("number"==typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new qn,this.toJSON())}_performRefresh(){return bn("not implemented")}}function Kn(t,e){wn("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Gn{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=dn(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wn(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await $n(this,this.stsTokenManager.getToken(this.auth,t));return wn(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=V(t),i=await n.getIdToken(e),s=Hn(i);wn(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:Fn(jn(s.auth_time)),issuedAtTime:Fn(jn(s.iat)),expirationTime:Fn(jn(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=V(t);await zn(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(wn(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Gn(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){wn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await zn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await $n(this,async function(t,e){return Pn(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,o,a,c,l;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,d=null!==(i=e.email)&&void 0!==i?i:void 0,u=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,p=null!==(r=e.photoURL)&&void 0!==r?r:void 0,f=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:I,stsTokenManager:_}=e;wn(y&&_,t,"internal-error");const T=qn.fromJSON(this.name,_);wn("string"==typeof y,t,"internal-error"),Kn(h,t.name),Kn(d,t.name),wn("boolean"==typeof w,t,"internal-error"),wn("boolean"==typeof b,t,"internal-error"),Kn(u,t.name),Kn(p,t.name),Kn(f,t.name),Kn(g,t.name),Kn(m,t.name),Kn(v,t.name);const S=new Gn({uid:y,auth:t,email:d,emailVerified:w,displayName:h,isAnonymous:b,photoURL:p,phoneNumber:u,tenantId:f,stsTokenManager:T,createdAt:m,lastLoginAt:v});return I&&Array.isArray(I)&&(S.providerData=I.map((t=>Object.assign({},t)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(t,e,n=!1){const i=new qn;i.updateFromServerResponse(e);const s=new Gn({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await zn(s),s}}const Jn=new Map;function Yn(t){In(t instanceof Function,"Expected a class definition");let e=Jn.get(t);return e?(In(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jn.set(t,e),e)}class Xn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Xn.type="NONE";const Zn=Xn;function Qn(t,e,n){return`firebase:${t}:${e}:${n}`}class ti{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Qn(this.userKey,i.apiKey,s),this.fullPersistenceKey=Qn("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Gn._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new ti(Yn(Zn),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||Yn(Zn);const r=Qn(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(r);if(e){const i=Gn._fromJSON(t,e);n!==s&&(o=i),s=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(t){}}))),new ti(s,t,n)):new ti(s,t,n)}}function ei(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ri(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ni(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ai(e))return"Blackberry";if(ci(e))return"Webos";if(ii(e))return"Safari";if((e.includes("chrome/")||si(e))&&!e.includes("edge/"))return"Chrome";if(oi(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ni(t=S()){return/firefox\//i.test(t)}function ii(t=S()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function si(t=S()){return/crios\//i.test(t)}function ri(t=S()){return/iemobile/i.test(t)}function oi(t=S()){return/android/i.test(t)}function ai(t=S()){return/blackberry/i.test(t)}function ci(t=S()){return/webos/i.test(t)}function li(t=S()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function hi(t=S()){return li(t)||oi(t)||ci(t)||ai(t)||/windows phone/i.test(t)||ri(t)}function di(t,e=[]){let n;switch(t){case"Browser":n=ei(S());break;case"Worker":n=`${ei(S())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ot}/${i}`}class ui{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class pi{constructor(t){var e,n,i,s;const r=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=r.minPasswordLength)&&void 0!==e?e:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(s=t.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,s,r,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsUppercaseLetter)||void 0===s||s),a.isValid&&(a.isValid=null===(r=a.containsNumericCharacter)||void 0===r||r),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class fi{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mi(this),this.idTokenSubscription=new mi(this),this.beforeStateQueue=new ui(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Yn(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ti.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return wn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await zn(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?V(t):null;return e&&wn(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&wn(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Yn(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Pn(t,"GET","/v2/passwordPolicy",xn(t,e))}(this),e=new pi(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new x("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Pn(t,"POST","/v2/accounts:revokeToken",xn(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Yn(t)||this._popupRedirectResolver;wn(e,this,"argument-error"),this.redirectPersistenceManager=await ti.create(this,[Yn(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"==typeof e?e:e.next.bind(e);let r=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(wn(o,this,"internal-error"),o.then((()=>{r||s(this.currentUser)})),"function"==typeof e){const s=t.addObserver(e,n,i);return()=>{r=!0,s()}}{const n=t.addObserver(e);return()=>{r=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return wn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=di(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){fn.logLevel<=J.WARN&&fn.warn(`Auth (${Ot}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function gi(t){return V(t)}class mi{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new M(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return wn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let vi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yi(t){return vi.loadJS(t)}function wi(t){return`__${t}${Math.floor(1e6*Math.random())}`}class bi{constructor(t){this.type="recaptcha-enterprise",this.auth=gi(t)}async verify(t="verify",e=!1){function n(e,n,i){const s=window.grecaptcha;Un(s)?s.enterprise.ready((()=>{s.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Pn(t,"GET","/v2/recaptchaConfig",xn(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Bn(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((s=>{if(!e&&Un(window.grecaptcha))n(s,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=vi.recaptchaEnterpriseScript;0!==e.length&&(e+=s),yi(e).then((()=>{n(s,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Ii(t,e,n,i=!1){const s=new bi(t);let r;try{r=await s.verify(n)}catch(t){r=await s.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function _i(t,e,n,i){var s;if(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Ii(t,e,n,"getOobCode"===n);return i(t,s)}return i(t,e).catch((async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await Ii(t,e,n,"getOobCode"===n);return i(t,s)}return Promise.reject(s)}))}function Ti(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Si(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Ei{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return bn("not implemented")}_getIdTokenResponse(t){return bn("not implemented")}_linkToIdToken(t,e){return bn("not implemented")}_getReauthenticationResolver(t){return bn("not implemented")}}async function ki(t,e){return Pn(t,"POST","/v1/accounts:signUp",e)}async function Ci(t,e){return On(t,"POST","/v1/accounts:signInWithPassword",xn(t,e))}class Ri extends Ei{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Ri(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Ri(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return _i(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ci);case"emailLink":return async function(t,e){return On(t,"POST","/v1/accounts:signInWithEmailLink",xn(t,e))}(t,{email:this._email,oobCode:this._password});default:mn(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return _i(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ki);case"emailLink":return async function(t,e){return On(t,"POST","/v1/accounts:signInWithEmailLink",xn(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:mn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function xi(t,e){return On(t,"POST","/v1/accounts:signInWithIdp",xn(t,e))}class Pi extends Ei{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Pi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):mn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=dn(e,["providerId","signInMethod"]);if(!n||!i)return null;const r=new Pi(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(t){return xi(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,xi(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,xi(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=N(e)}return t}}const Ai={USER_NOT_FOUND:"user-not-found"};class Oi extends Ei{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Oi({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Oi({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return On(t,"POST","/v1/accounts:signInWithPhoneNumber",xn(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await On(t,"POST","/v1/accounts:signInWithPhoneNumber",xn(t,e));if(n.temporaryProof)throw Mn(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return On(t,"POST","/v1/accounts:signInWithPhoneNumber",xn(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Ai)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}=t;return n||e||i||s?new Oi({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class Ni{constructor(t){var e,n,i,s,r,o;const a=L(D(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);wn(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=L(D(t)).link,n=e?L(D(e)).deep_link_id:null,i=L(D(t)).deep_link_id;return(i?L(D(i)).link:null)||i||n||e||t}(t);try{return new Ni(e)}catch(t){return null}}}class Li{constructor(){this.providerId=Li.PROVIDER_ID}static credential(t,e){return Ri._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Ni.parseLink(e);return wn(n,"argument-error"),Ri._fromEmailAndCode(t,n.code,n.tenantId)}}Li.PROVIDER_ID="password",Li.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Li.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Di{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Mi extends Di{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Ui extends Mi{constructor(){super("facebook.com")}static credential(t){return Pi._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ui.credentialFromTaggedObject(t)}static credentialFromError(t){return Ui.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ui.credential(t.oauthAccessToken)}catch(t){return null}}}Ui.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ui.PROVIDER_ID="facebook.com";class Bi extends Mi{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Pi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Bi.credentialFromTaggedObject(t)}static credentialFromError(t){return Bi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return Bi.credential(e,n)}catch(t){return null}}}Bi.GOOGLE_SIGN_IN_METHOD="google.com",Bi.PROVIDER_ID="google.com";class Fi extends Mi{constructor(){super("github.com")}static credential(t){return Pi._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Fi.credentialFromTaggedObject(t)}static credentialFromError(t){return Fi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Fi.credential(t.oauthAccessToken)}catch(t){return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com",Fi.PROVIDER_ID="github.com";class ji extends Mi{constructor(){super("twitter.com")}static credential(t,e){return Pi._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ji.credentialFromTaggedObject(t)}static credentialFromError(t){return ji.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ji.credential(e,n)}catch(t){return null}}}async function Hi(t,e){return On(t,"POST","/v1/accounts:signUp",xn(t,e))}ji.TWITTER_SIGN_IN_METHOD="twitter.com",ji.PROVIDER_ID="twitter.com";class $i{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const s=await Gn._fromIdTokenResponse(t,n,i),r=Vi(n);return new $i({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=Vi(n);return new $i({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function Vi(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Wi extends R{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Wi.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Wi(t,e,n,i)}}function zi(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Wi._fromErrorAndOperation(t,n,e,i);throw n}))}async function qi(t,e,n=!1){const i="signIn",s=await zi(t,i,e),r=await $i._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}async function Ki(t){const e=gi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}new WeakMap;const Gi="__sak";class Ji{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Gi,"1"),this.storage.removeItem(Gi),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Yi extends Ji{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=S();return ii(t)||li(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=hi(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);!function(){const t=S();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||s===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Yi.type="LOCAL";const Xi=Yi;class Zi extends Ji{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Zi.type="SESSION";const Qi=Zi;class ts{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new ts(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async t=>t(e.origin,s))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function es(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}ts.receivers=[];class ns{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const c=es("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(e.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function is(){return window}function ss(){return void 0!==is().WorkerGlobalScope&&"function"==typeof is().importScripts}const rs="firebaseLocalStorageDb",os="firebaseLocalStorage",as="fbase_key";class cs{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function ls(t,e){return t.transaction([os],e?"readwrite":"readonly").objectStore(os)}function hs(){const t=indexedDB.open(rs,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(os,{keyPath:as})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(os)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(rs);return new cs(t).toPromise()}(),e(await hs()))}))}))}async function ds(t,e,n){const i=ls(t,!0).put({[as]:e,value:n});return new cs(i).toPromise()}function us(t,e){const n=ls(t,!0).delete(e);return new cs(n).toPromise()}class ps{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await hs()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ss()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ts._getInstance(ss()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new ns(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await hs();return await ds(t,Gi,"1"),await us(t,Gi),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>ds(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=ls(t,!1).get(e),i=await new cs(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>us(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=ls(t,!1).getAll();return new cs(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ps.type="LOCAL";const fs=ps;wi("rcb"),new Sn(3e4,6e4);class gs{constructor(t){this.providerId=gs.PROVIDER_ID,this.auth=gi(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const s=await n.verify();try{let r;if(wn("string"==typeof s,t,"argument-error"),wn("recaptcha"===n.type,t,"argument-error"),r="string"==typeof e?{phoneNumber:e}:e,"session"in r){const e=r.session;if("phoneNumber"in r){wn("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Pn(t,"POST","/v2/accounts/mfaEnrollment:start",xn(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{wn("signin"===e.type,t,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;wn(n,t,"missing-multi-factor-info");const o=await function(t,e){return Pn(t,"POST","/v2/accounts/mfaSignIn:start",xn(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Pn(t,"POST","/v1/accounts:sendVerificationCode",xn(t,e))}(t,{phoneNumber:r.phoneNumber,recaptchaToken:s});return e}}finally{n._reset()}}(this.auth,t,V(e))}static credential(t,e){return Oi._fromVerification(t,e)}static credentialFromResult(t){const e=t;return gs.credentialFromTaggedObject(e)}static credentialFromError(t){return gs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Oi._fromTokenResponse(e,n):null}}gs.PROVIDER_ID="phone",gs.PHONE_SIGN_IN_METHOD="phone";class ms extends Ei{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return xi(t,this._buildIdpRequest())}_linkToIdToken(t,e){return xi(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return xi(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function vs(t){return qi(t.auth,new ms(t),t.bypassAuthState)}function ys(t){const{auth:e,user:n}=t;return wn(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,s="reauthenticate";try{const r=await $n(t,zi(i,s,e,t),n);wn(r.idToken,i,"internal-error");const o=Hn(r.idToken);wn(o,i,"internal-error");const{sub:a}=o;return wn(t.uid===a,i,"user-mismatch"),$i._forOperation(t,s,r)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&mn(i,"user-mismatch"),t}}(n,new ms(t),t.bypassAuthState)}async function ws(t){const{auth:e,user:n}=t;return wn(n,e,"internal-error"),async function(t,e,n=!1){const i=await $n(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return $i._forOperation(t,"link",i)}(n,new ms(t),t.bypassAuthState)}class bs{constructor(t,e,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=t;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return vs;case"linkViaPopup":case"linkViaRedirect":return ws;case"reauthViaPopup":case"reauthViaRedirect":return ys;default:mn(this.auth,"internal-error")}}resolve(t){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Is=new Sn(2e3,1e4);class _s extends bs{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,_s.currentPopupAction&&_s.currentPopupAction.cancel(),_s.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return wn(t,this.auth,"internal-error"),t}async onExecution(){In(1===this.filter.length,"Popup operations only handle one event");const t=es();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(vn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(vn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_s.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(vn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Is.get())};t()}}_s.currentPopupAction=null;const Ts="pendingRedirect",Ss=new Map;class Es extends bs{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Ss.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Qn(Ts,t.config.apiKey,t.name)}(e),i=function(t){return Yn(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Ss.set(this.auth._key(),t)}return this.bypassAuthState||Ss.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ks(t,e){Ss.set(t._key(),e)}async function Cs(t,e,n=!1){const i=gi(t),s=function(t,e){return e?Yn(e):(wn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),r=new Es(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Rs{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ps(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Ps(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(vn(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xs(t))}saveEventToCache(t){this.cachedEventUids.add(xs(t)),this.lastProcessedEventTime=Date.now()}}function xs(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Ps({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const As=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Os=/^https?/;function Ns(t){const e=_n(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!Os.test(n))return!1;if(As.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const Ls=new Sn(3e4,6e4);function Ds(){const t=is().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function Ms(t){return new Promise(((e,n)=>{var i,s,r;function o(){Ds(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ds(),n(vn(t,"network-request-failed"))},timeout:Ls.get()})}if(null===(s=null===(i=is().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=is().gapi)||void 0===r?void 0:r.load)){const e=wi("iframefcb");return is()[e]=()=>{gapi.load?o():n(vn(t,"network-request-failed"))},yi(`${vi.gapiScript}?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw Us=null,t}))}let Us=null;const Bs=new Sn(5e3,15e3),Fs="__/auth/iframe",js="emulator/auth/iframe",Hs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$s=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Vs(t){const e=t.config;wn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?En(e,js):`https://${t.config.authDomain}/${Fs}`,i={apiKey:e.apiKey,appName:t.name,v:Ot},s=$s.get(t.config.apiHost);s&&(i.eid=s);const r=t._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${N(i).slice(1)}`}const Ws={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zs{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const qs=encodeURIComponent("fac");async function Ks(t,e,n,i,s,r){wn(t.config.authDomain,t,"auth-domain-config-required"),wn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:Ot,eventId:s};if(e instanceof Di){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(r||{}))o[t]=e}if(e instanceof Mi){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),l=c?`#${qs}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?En(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${N(a).slice(1)}${l}`}const Gs="webStorageSupport",Js=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qi,this._completeRedirectFn=Cs,this._overrideRedirectResult=ks}async _openPopup(t,e,n,i){var s;return In(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,s=600){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Ws),{width:i.toString(),height:s.toString(),top:r,left:o}),l=S().toLowerCase();n&&(a=si(l)?"_blank":n),ni(l)&&(e=e||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=S()){var e;return li(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new zs(null);const d=window.open(e||"",a,h);wn(d,t,"popup-blocked");try{d.focus()}catch(t){}return new zs(d)}(t,await Ks(t,e,n,_n(),i),es())}async _openRedirect(t,e,n,i){return await this._originValidation(t),s=await Ks(t,e,n,_n(),i),is().location.href=s,new Promise((()=>{}));var s}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(In(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return Us=Us||Ms(t),Us}(t),n=is().gapi;return wn(n,t,"internal-error"),e.open({where:document.body,url:Vs(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Hs,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=vn(t,"network-request-failed"),r=is().setTimeout((()=>{i(s)}),Bs.get());function o(){is().clearTimeout(r),n(e)}e.ping(o).then(o,(()=>{i(s)}))}))))}(t),n=new Rs(t);return e.register("authEvent",(e=>(wn(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Gs,{type:Gs},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Gs];void 0!==s&&e(!!s),mn(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Pn(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Ns(t))return}catch(t){}mn(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return hi()||ii()||li()}};var Ys="@firebase/auth",Xs="1.6.0";class Zs{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){wn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Qs=_("authIdTokenMaxAge")||300;let tr=null;var er;vi={loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=vn("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},er="Browser",Rt(new W("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:r,authDomain:o}=n.options;wn(r&&!r.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:r,authDomain:o,clientPlatform:er,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:di(er)},c=new fi(n,i,s,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Yn);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),Rt(new W("auth-internal",(t=>(t=>new Zs(t))(gi(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Dt(Ys,Xs,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(er)),Dt(Ys,Xs,"esm2017"),function(t=Lt()){const e=xt(t=V(t),Le);e.isInitialized()?e.getImmediate():function(t,e={}){const n=xt(t,Le);if(n.isInitialized()){const t=n.getImmediate();if(A(e,n.getOptions()))return t;throw He.create("already-initialized")}n.initialize({options:e})}(t)}(Nt({apiKey:"AIzaSyAWYD3cjmiGJfMW6U4qVEyzV-f2L2Bsdew",authDomain:"zuma-ca665.firebaseapp.com",projectId:"zuma-ca665",storageBucket:"zuma-ca665.appspot.com",messagingSenderId:"199514844710",appId:"1:199514844710:web:42a7fdb906f18aa7f540e7",measurementId:"G-5SQ2FBYWYR"}));const nr=function(t=Lt()){const e=xt(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=xt(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(A(n.getOptions(),null!=e?e:{}))return t;mn(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Js,persistence:[fs,Xi,Qi]}),i=_("authTokenSyncURL");if(i){const t=(s=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Qs)return;const i=null==e?void 0:e.token;tr!==i&&(tr=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){V(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,s){V(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var s;const r=(o="auth",null===(c=null===(a=b())||void 0===a?void 0:a.emulatorHosts)||void 0===c?void 0:c[o]);var o,a,c;return r&&function(t,e,n){const i=gi(t);wn(i._canInitEmulator,i,"emulator-config-failed"),wn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),r=Ti(e),{host:o,port:a}=function(t){const e=Ti(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const t=s[1];return{host:t,port:Si(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Si(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${r}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${r}`),n}(),ir=n.p+"zuma_logo.png",sr=n.p+"error.png",rr=n.p+"blueBall.jpg",or=n.p+"yellowBall.jpg",ar=n.p+"redBall.jpg",cr=n.p+"greenBall.jpg",lr=n.p+"track.jpg",hr=n.p+"frog.png",dr={id:"main",title:"Main",render:(t="container")=>`\n\t\t<section class="${t} main">\n\t\t\t<h2 class="main-title">Welcome to the wonderful world of Zuma!</h2>\n\t\t</section>\n\t`},ur={id:"game",title:"Game",render:(t="container")=>`\n\t\t<section class="${t} game">\n\t\t\t<div class="game-field">\n\t\t\t\t<div class="game-score">SCORE: 0</div>\n\t\t\t\t<button class="sound-on" id="sound"></button>\n\t\t\t</div>\n\t\t\t<canvas id="canvas" class="${t}"></canvas>\n\t\t</section>\n\t`},pr={id:"rules",title:"Rules",render:(t="container")=>`\n\t\t<section class="${t} rules">\n\t\t<h2 class="rules-title">Rules game:</h2>\n\t\t<div class="rules-container">\n\t\t\t<p class="rules-text">The game "Zuma" is controlled with the mouse.</p>\n\t\t\t<p class="rules-text">The aim is the cursor.</p>\n\t\t\t<p class="rules-text">Shoot the balls with the left click, trying to get into groups of two or more balls of the same color.</p>\n\t\t</div>\n\t</section>\n\t`},fr={id:"records",title:"Records",render:(t="container")=>`\n\t\t<section class="${t} records">\n\t\t\t<h1 class="records-title">Records</h1>\n\t\t\t\t<table class="records-table">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan="2"></td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr class="top_five">\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t</section>\n\t`},gr={id:"error",title:"Error",render:(t="container")=>`\n\t\t<section class="${t} error">\n\t\t<img class="error-img" src="${sr}" alt="error 404">\n\t\t<p class="error-text"><span>404</span> Sorry this page not found, please try to return to the <a\n\t\t\t\thref="#main">main page</a>.</p>\n\t</section>\n\t`};let mr={levelBg:lr,ballsColor:[rr,or,ar,cr],offsetFrogLeft:2.9,offsetFrogTop:2.5,totalBalls:140,points:[{x:1179,y:1e3},{x:1179,y:556},{x:1168,y:387},{x:1144,y:276},{x:1102,y:188},{x:1055,y:129},{x:1020,y:103},{x:937,y:69},{x:843,y:61},{x:721,y:74},{x:562,y:117},{x:455,y:162},{x:346,y:219},{x:245,y:289},{x:148,y:384},{x:86,y:475},{x:68,y:547},{x:79,y:580},{x:116,y:625},{x:177,y:671},{x:258,y:703},{x:364,y:724},{x:460,y:735},{x:574,y:735},{x:686,y:737},{x:767,y:728},{x:849,y:713},{x:928,y:685},{x:994,y:641},{x:1046,y:575},{x:1060,y:510},{x:1061,y:422},{x:1056,y:361},{x:1035,y:290},{x:1008,y:226},{x:977,y:192},{x:964,y:184},{x:950,y:200},{x:920,y:281},{x:888,y:369},{x:836,y:493},{x:797,y:562},{x:748,y:604},{x:683,y:634},{x:608,y:651},{x:521,y:649},{x:429,y:636},{x:360,y:620},{x:284,y:574},{x:246,y:522},{x:241,y:489},{x:267,y:432},{x:306,y:390},{x:372,y:339},{x:455,y:285},{x:544,y:230},{x:638,y:180},{x:704,y:155},{x:746,y:148},{x:768,y:160},{x:772,y:172},{x:757,y:236}]};class vr{step;point0;point1;point2;ax;ay;bx;by;A;B;C;totalLength;init(t,e,n,i){return this.point0=t,this.point1=e,this.point2=n,this.ax=this.point0.x-2*this.point1.x+this.point2.x,this.ay=this.point0.y-2*this.point1.y+this.point2.y,this.bx=2*this.point1.x-2*this.point0.x,this.by=2*this.point1.y-2*this.point0.y,this.A=4*(Math.pow(this.ax,2)+Math.pow(this.ay,2)),this.B=4*(this.ax*this.bx+this.ay*this.by),this.C=Math.pow(this.bx,2)+Math.pow(this.by,2),this.totalLength=this.length(1),this.step=Math.floor(this.totalLength/i),this.totalLength%i>i/2&&this.step++,this.step}speed(t){return Math.sqrt(this.A*t*t+this.B*t+this.C)}length(t){let e=Math.sqrt(this.C+t*(this.B+this.A*t)),n=2*this.A*t*e+this.B*(e-Math.sqrt(this.C)),i=Math.log(this.B+2*Math.sqrt(this.A)*Math.sqrt(this.C)),s=Math.log(this.B+2*this.A*t+2*Math.sqrt(this.A)*e);return(2*Math.sqrt(this.A)*n+(this.B*this.B-4*this.A*this.C)*(i-s))/(8*Math.pow(this.A,1.5))}invertL(t,e){let n,i=t;for(;n=i-(this.length(i)-e)/this.speed(i),!(Math.abs(i-n)<1e-6);)i=n;return n}getPoint(t,e){return{x:t,y:e}}getAnchorPoint(t){if(t>=0&&t<=this.step){let e=t/this.step,n=e*this.totalLength;e=this.invertL(e,n);let i=Math.pow(1-e,2)*this.point0.x+2*(1-e)*e*this.point1.x+e*e*this.point2.x,s=Math.pow(1-e,2)*this.point0.y+2*(1-e)*e*this.point1.y+e*e*this.point2.y,r=this.getPoint((1-e)*this.point0.x+e*this.point1.x,(1-e)*this.point0.y+e*this.point1.y),o=this.getPoint((1-e)*this.point1.x+e*this.point2.x,(1-e)*this.point1.y+e*this.point2.y),a=o.x-r.x,c=o.y-r.y;return{x:i,y:s,degrees:180*Math.atan2(c,a)/Math.PI}}return{}}}class yr{constructor(){this.track=[]}getPoint(t,e){return{x:t,y:e}}getPoints(){let t=mr.points,e=new vr;for(let n=0;n<t.length-2;++n){let i=0===n?this.getPoint(t[0].x,t[0].y):this.getPoint((t[n].x+t[n+1].x)/2,(t[n].y+t[n+1].y)/2),s=this.getPoint(t[n+1].x,t[n+1].y),r=n<=t.length-4?this.getPoint((t[n+1].x+t[n+2].x)/2,(t[n+1].y+t[n+2].y)/2):this.getPoint(t[n+2].x,t[n+2].y),o=e.init(i,s,r,1);for(let t=1;t<=o;++t){let n=e.getAnchorPoint(t);this.track.push(n)}}}getTrack(){return this.getPoints(),this.track}}class wr{constructor(){this.track=(new yr).getTrack(),this.levelBg=mr.levelBg,this.colors=mr.ballsColor,this.totalBalls=mr.totalBalls,this.ratio=4/3,this.canvasWidth=600,this.canvasHeight=400,this.frog=this.createFrog(),this.shot=this.createShot(),this.ballRadius=this.createBall(),this.track=this.createTrack()}createBall(){return this.canvasWidth/70}createShot(){return{radius:this.canvasWidth/70,left:this.canvasWidth/mr.offsetFrogLeft+this.canvasWidth/6.15/2,top:this.canvasHeight/mr.offsetFrogTop+this.canvasWidth/6.15/2}}createFrog(){return{width:this.canvasWidth/6.15,height:this.canvasWidth/6.15,left:this.canvasWidth/mr.offsetFrogLeft,top:this.canvasHeight/mr.offsetFrogTop}}createTrack(){let t=this.track,e=this.canvasWidth/1280,n=this.canvasHeight/820,i=[];for(let s=0;s<t.length;s++)i.push({x:t[s].x*e,y:t[s].y*n});return i}}class br{constructor(t){this.model=t,this.context=document.getElementById("canvas").getContext("2d")}createCanvas(){let t=document.getElementById("canvas");t.width=this.model.canvasWidth,t.height=this.model.canvasHeight}draw(){let t=new Image;t.src=this.model.levelBg,this.context.drawImage(t,0,0,this.model.canvasWidth,this.model.canvasHeight)}}n.p;const Ir=n.p+"main.mp3",_r=(n.p,n.p+"fireball.mp3");n.p,n.p,n.p;class Tr extends wr{constructor(){super(),this.frogAngle=0,this.shotSpeed=0,this.shotAngle=0,this.shotState=0,this.down=0,this.shotRadius=this.shot.radius,this.shotLeft=this.shot.left,this.shotTop=this.shot.top,this.color=0,this.canShoot=!1,this.secondShotLeft=this.shot.left,this.secondShotTop=this.shot.top,this.secondShotColor=0,this.frogWidth=this.frog.width,this.frogHeight=this.frog.height,this.frogLeft=this.frog.left,this.frogTop=this.frog.top,this.getRandomColor(),this.getRandomSecondShotColor()}getRandomColor(){let t=Math.floor(Math.random()*this.colors.length);this.color=this.colors[t]}getRandomSecondShotColor(){let t=Math.floor(Math.random()*this.colors.length);this.secondShotColor=this.colors[t]}updateFrogAngle(t,e){this.frogAngle=Math.atan2(-(t-(this.frogLeft+this.frogWidth/2)),e-(this.frogTop+this.frogHeight/2))}updateShotAngle(t,e){this.shotAngle=Math.atan2(t-(this.frogLeft+this.frogWidth/2),e-(this.frogTop+this.frogHeight/2))}updateShot(){this.shotLeft+=Math.sin(this.shotAngle)*this.shotSpeed,this.shotTop+=Math.cos(this.shotAngle)*this.shotSpeed}stopShot(){this.shotState=0,this.shotSpeed=0,this.shotAngle=-this.frogAngle,this.shotLeft=this.frogLeft+this.frogWidth/2,this.shotTop=this.frogTop+this.frogHeight/2,this.down=0,this.color=this.secondShotColor,this.getRandomSecondShotColor(),1===this.colors.length&&(this.color=this.secondShotColor,this.getRandomSecondShotColor())}restartShot(){this.shotSpeed=0,this.shotState=0,this.shotAngle=-this.frogAngle,this.shotLeft=this.frogLeft+this.frogWidth/2,this.shotTop=this.frogTop+this.frogHeight/2,this.color=this.secondShotColor,this.getRandomSecondShotColor()}}class Sr extends br{frame=0;numberOfRows=10;numberOfCols=6;tickPerFrame=1;tickCount=0;spriteWidth=300;spriteHeight=180;rowCount=0;constructor(t){super(),this.model=t,this.color=this.model.color,this.secondColor=this.model.secondShotColor}drawFrog(){let t=new Image;t.src=hr,this.context.save(),this.context.beginPath(),this.context.arc(this.model.frogLeft+this.model.frogWidth/2,this.model.frogTop+this.model.frogHeight/2,this.model.frogWidth/2,0,2*Math.PI,!1),this.context.closePath(),this.context.clip(),this.context.translate(this.model.frogLeft+this.model.frogWidth/2,this.model.frogTop+this.model.frogHeight/2),this.context.rotate(this.model.frogAngle),this.context.drawImage(t,-this.model.frogWidth/2,-this.model.frogHeight/2,this.model.frogWidth,this.model.frogHeight),this.context.restore()}drawShot(){let t=new Image;t.src=this.color,this.context.save(),this.context.beginPath(),this.context.arc(this.model.frogLeft+this.model.frogWidth/2,this.model.frogTop+this.model.frogHeight/2,this.model.frogWidth/2,0,2*Math.PI,!1),this.context.closePath(),this.context.translate(this.model.shotLeft,this.model.shotTop),this.context.rotate(-this.model.shotAngle),this.context.beginPath(),this.context.arc(0,this.model.frogHeight/4,this.model.shotRadius,0,2*Math.PI,!0),this.context.closePath(),this.context.clip(),this.animateColor(t),this.context.restore()}animateColor(t){this.context.translate(0,0),this.context.drawImage(t,this.frame*this.spriteWidth/this.numberOfRows,this.rowCount*this.spriteHeight/this.numberOfCols,this.spriteWidth/this.numberOfRows,this.spriteHeight,-this.model.shotRadius,-this.model.shotRadius+this.model.frogHeight/4,2*this.model.shotRadius*10/this.numberOfRows,2*this.model.shotRadius*6),this.tickCount>this.tickPerFrame&&(this.tickCount=0,this.frame===this.numberOfRows-1&&this.rowCount++,6===this.rowCount&&(this.rowCount=0),this.frame=this.frame<this.numberOfRows-1?this.frame+=1:this.frame=0),this.tickCount++}drawSecondBall(){let t=new Image;t.src=this.secondColor,this.context.save(),this.context.beginPath(),this.context.arc(this.model.frogLeft+this.model.frogWidth/2,this.model.frogTop+this.model.frogHeight/2,this.model.frogWidth/2+2,0,2*Math.PI,!1),this.context.closePath(),this.context.translate(this.model.secondShotLeft,this.model.secondShotTop),this.context.rotate(this.model.frogAngle),this.context.beginPath(),this.context.arc(0,-this.model.frogHeight/5,this.model.shotRadius/2+1,0,2*Math.PI,!1),this.context.closePath(),this.context.clip(),this.context.fill(),this.context.translate(0,0),this.context.drawImage(t,0,0,30,30,-this.model.shotRadius/2-2,-this.model.frogHeight/5-this.model.shotRadius/2-1,this.model.shotRadius+3,this.model.shotRadius+3),this.context.restore()}draw(){this.drawFrog(),this.drawShot(),this.drawSecondBall()}}class Er{constructor(){this.model=new Tr,this.view=new Sr(this.model),this.moveFrog(),this.shot(),this.swapColor()}moveFrog(){let t=document.getElementById("canvas");t.addEventListener("mousemove",(e=>{let n=e.clientX-t.getBoundingClientRect().x,i=e.clientY-t.getBoundingClientRect().y;this.model.updateFrogAngle(n,i),0===this.model.shotState&&this.model.updateShotAngle(n,i)}))}shot(){document.getElementById("canvas").addEventListener("click",(t=>{this.model.shotSpeed=this.model.frogWidth/10,this.model.shotState=1,this.fireSound().play()}))}fireSound(){let t=new Audio;return t.src=_r,t}restartShot(){let t=document.getElementById("canvas"),e=t.offsetWidth,n=t.offsetHeight;(this.model.shotLeft-this.model.shotRadius<t.offsetLeft-e||this.model.shotTop-this.model.shotRadius<t.offsetTop-n||this.model.shotLeft+this.model.shotRadius>t.offsetWidth||this.model.shotTop+this.model.shotRadius>t.offsetHeight)&&(this.model.restartShot(),this.view.secondColor=this.model.secondShotColor,this.view.color=this.model.color)}stopShot(){1===this.model.down&&(this.model.stopShot(),this.view.secondColor=this.model.secondShotColor,this.view.color=this.model.color)}swapColor(){window.oncontextmenu=function(t){return!1},window.addEventListener("mousedown",(t=>{if(2===t.button){let t=this.model.color,e=this.model.secondShotColor;this.model.color=e,this.model.secondShotColor=t,this.view.color=e,this.view.secondColor=t}}))}draw(){this.stopShot(),this.restartShot(),this.view.draw(),this.model.updateShot()}}class kr extends wr{constructor(){super(),this.trackSection=0,this.ballsColor=this.colors,this.width=this.canvasWidth,this.height=this.canvasHeight,this.color=0,this.getRandomColor()}createPosition(t){this.trackSection=t,this.x=this.track[this.trackSection].x,this.y=this.track[this.trackSection].y}getRandomColor(){let t=Math.floor(Math.random()*this.colors.length);this.color=this.colors[t]}getTrackSection(){return this.trackSection}updateSize(t,e){this.ballRadius=t/63;let n=this.track,i=t/this.width,s=e/this.height,r=[];for(let t=0;t<n.length;t++)r.push({x:n[t].x*i,y:n[t].y*s});r.length===this.track.length&&(this.track=r,this.width=t,this.height=e)}update(t){let e=this.trackSection+t;this.createPosition(e)}}class Cr extends br{frame=0;numberOfRows=10;numberOfCols=6;tickPerFrame=1;tickCount=0;spriteWidth=300;spriteHeight=180;rowCount=0;constructor(t){super(),this.model=t,this.color=this.model.color}drawBall(){let t=new Image;t.src=this.color,this.context.save(),this.context.beginPath(),this.context.arc(this.model.x,this.model.y,this.model.ballRadius,0,2*Math.PI,!1),this.context.closePath(),this.context.clip(),this.animateColor(t),this.context.restore()}animateColor(t){this.context.translate(this.model.x-this.model.ballRadius,this.model.y-this.model.ballRadius),this.context.drawImage(t,this.frame*this.spriteWidth/this.numberOfRows,this.rowCount*this.spriteHeight/this.numberOfCols,this.spriteWidth/this.numberOfRows,this.spriteHeight,0,0,2*this.model.ballRadius*10/this.numberOfRows,2*this.model.ballRadius*6),this.tickCount>this.tickPerFrame&&(this.tickCount=0,this.frame===this.numberOfRows-1&&this.rowCount++,6===this.rowCount&&(this.rowCount=0),this.frame=this.frame<this.numberOfRows-1?this.frame+=1:this.frame=0),this.tickCount++}draw(){this.drawBall()}}class Rr{constructor(){this.score=0}updateGameScore(){document.querySelector(".game-score").textContent=`SCORE : ${this.score}`}}class xr{constructor(t,e){this.frog=e,this.totalBalls=t,this.player=new Rr,this.balls=[],this.spacing=36,this.track=[],this.views=[],this.createFirstBall(),this.gameEnd=!1,this.ballNeedShift=!1,this.shiftedBalls=[],this.ballCounter=0,this.currentCombo=0,this.maxCombo=0,this.multiplierCombo=1,this.comboCounter=0,this.checkUnload(),this.music=this.createMusic()}createFirstBall(){let t=this.createRandomBall(),e=new Cr(t);this.views.unshift(e),this.balls.unshift(t),t.createPosition(this.spacing),this.track=t.track}createBalls(){if(0!==this.balls.length&&(this.pushNextBall(0,1),this.balls[0].getTrackSection()===2*this.spacing&&0!==this.totalBalls&&this.totalBalls>0)){let t=this.createRandomBall(),e=new Cr(t);this.views.unshift(e),this.balls.unshift(t),t.createPosition(this.spacing)}}createRandomBall(){return this.totalBalls--,this.ballCounter++,new kr}pushBall(t,e){let n;for(let t=0;t<this.balls.length;t++){if(this.balls[t].trackSection>e){n=t;break}t===this.balls.length-1&&(n=t+1)}t.createPosition(e),this.balls.splice(n,0,t),this.frog.colors=this.checkColor();let i=new Cr(t);this.views.splice(n,0,i),this.balls[n-1]&&this.balls[n-1].color===this.balls[n].color&&this.balls[n].getTrackSection()-this.balls[n-1].getTrackSection()>this.spacing+1&&this.addShiftedBall(t),this.balls[n+1]&&this.balls[n+1].color===this.balls[n].color&&this.balls[n+1].getTrackSection()-this.balls[n].getTrackSection()>this.spacing+1&&this.addShiftedBall(this.balls[n+1]),this.checkTail(n,!0)}pushNextBall(t,e){let n=[];n.push(this.balls[t]);for(let e=t;e<this.balls.length-1&&this.balls[e+1].getTrackSection()-this.balls[e].getTrackSection()<=this.spacing;e++)this.balls[e+1].getTrackSection()-this.balls[e].getTrackSection()<this.spacing&&this.balls[e+1].update(4),n.push(this.balls[e+1]);for(let t=this.balls.length-1;t>0;t--)this.balls[t].getTrackSection()-this.balls[t-1].getTrackSection()<this.spacing&&this.balls[t].update(4);for(let t=0;t<n.length;t++)n[t].update(e);this.balls[this.balls.length-1].getTrackSection()>=this.track.length-this.spacing&&(this.balls.splice(this.balls.length-2,1),2===this.balls.length&&(this.gameEnd=!0,this.frog.canShoot=0,this.music.main.pause()),this.gameEnd&&setTimeout((()=>{}),500))}checkCollision(t){for(let e=0;e<this.balls.length;e++){let n=this.balls[e].x-t.x,i=this.balls[e].y-t.y;if(Math.sqrt(n*n+i*i)<=2*this.balls[e].ballRadius)return this.frog.down=1,e}return-1}checkPosition(t,e,n){let i;"next"===n?i=this.balls[e].getTrackSection():"previous"===n&&(i=this.balls[e].getTrackSection()-this.spacing),this.pushBall(t,i)}checkColor(){let t=[];for(let e=0;e<this.balls.length;e++)t.push(this.balls[e].color);return Array.from(new Set(t))}checkTail(t,e){let n=[];n.push(this.balls[t]);let i=this.balls[t].color,s=t+1;for(;this.balls[s]&&this.balls[s].color===i;)if(this.balls[s].getTrackSection()-this.balls[s-1].getTrackSection()<=this.spacing+1)n.push(this.balls[s]),s++;else{if(e)break;n.push(this.balls[s]),s++}let r=t-1;for(;this.balls[r]&&this.balls[r].color===i;)if(this.balls[r+1].getTrackSection()-this.balls[r].getTrackSection()<=this.spacing+1)n.push(this.balls[r]),r--;else{if(e)break;n.push(this.balls[r]),r--}return r++,n.length>2&&e&&this.clearBalls(r,n),n.length}clearBalls(t,e){this.currentCombo++,this.checkWinGame(e);let n=0;for(let t=0;t<e.length;t++)n+=10+this.frog.level;n*=this.multiplierCombo*this.frog.level,this.player.score+=n,this.balls.splice(t,e.length),this.views.splice(t,e.length),this.gameEnd||(this.frog.colors=this.checkColor()),this.balls[t-1]&&this.balls[t]&&this.balls[t-1].color===this.balls[t].color?(this.checkTail(t,!1)<3&&(this.currentCombo>this.maxCombo&&(this.maxCombo=this.currentCombo),this.comboCounter+=this.currentCombo,this.currentCombo=0),this.addShiftedBall(this.balls[t])):(this.currentCombo>this.maxCombo&&(this.maxCombo=this.currentCombo),this.comboCounter+=this.currentCombo,this.currentCombo=0)}checkWinGame(t){if(this.balls.length===t.length){this.gameEnd=!0,this.music.main.pause(),this.frog.canShoot=0,this.player.getExtraScore(this.track,this.balls[this.balls.length-1].getTrackSection(),this.frog.level);let t=localStorage.getItem("level"),e=this.frog.level+1;e<t?localStorage.setItem("level",t):e>t&&this.frog.level<9&&localStorage.setItem("level",String(e)),setTimeout((()=>{this.player.checkScore(this.player.score),this.player.nextLevel("win",this.frog.level,this.ballCounter,this.player.score)}),5e3)}}addShiftedBall(t){null===this.shiftedBalls?(this.shiftedBalls=[],this.shiftedBalls.push(t)):this.shiftedBalls.push(t),setTimeout((()=>{this.ballNeedShift=!0,this.music.shifted.currentTime=0,this.music.shifted.play()}),100)}shiftOfTwoTails(){if(0!==this.shiftedBalls.length)for(let t=0;t<this.shiftedBalls.length;t++){let e=this.balls.indexOf(this.shiftedBalls[t]);if(-1!==e&&this.balls[e-1])if(this.shiftedBalls[t].color===this.balls[e-1].color){let n;n=this.shiftedBalls[t].getTrackSection()-this.balls[e-1].getTrackSection()>this.spacing+2?3:10,this.pushNextBall(e,-n),this.shiftedBalls[t].getTrackSection()-this.balls[e-1].getTrackSection()<=this.spacing&&(this.multiplierCombo++,this.shiftedBalls.splice(t,1),this.checkTail(e-1,!0),0===this.shiftedBalls.length&&(this.ballNeedShift=!1,this.multiplierCombo=1))}else this.shiftedBalls.splice(t,1),this.currentCombo>this.maxCombo&&(this.maxCombo=this.currentCombo),this.comboCounter+=this.currentCombo,this.currentCombo=0}else this.ballNeedShift=!1,this.multiplierCombo=1}shooting(){if(1===this.frog.shotState){let t=this.checkCollision({x:this.frog.shotLeft,y:this.frog.shotTop});if(-1!==t){let e=this.track[this.balls[t].getTrackSection()-Math.ceil(this.balls[t].ballRadius)].x,n=this.track[this.balls[t].getTrackSection()-Math.ceil(this.balls[t].ballRadius)].y,i=Math.sqrt((this.frog.shotLeft-e)*(this.frog.shotLeft-e)+(this.frog.shotTop-n)*(this.frog.shotTop-n)),s=this.track[this.balls[t].getTrackSection()+Math.ceil(this.balls[t].ballRadius)].x,r=this.track[this.balls[t].getTrackSection()+Math.ceil(this.balls[t].ballRadius)].y,o=(i=Math.sqrt((this.frog.shotLeft-s)*(this.frog.shotLeft-s)+(this.frog.shotTop-r)*(this.frog.shotTop-r)))?"next":"previous",a=this.createRandomBall();a.color=this.frog.color,this.checkPosition(a,t,o)}}}draw(){if(this.player.updateGameScore(),this.ballNeedShift&&this.shiftOfTwoTails(),this.shooting(),!this.gameEnd){this.gameEnd||(this.frog.canShoot=1,this.createBalls());for(let t=0;t<this.balls.length;t++)this.views[t].draw()}}checkUnload(){window.addEventListener("beforeunload",(t=>{this.gameEnd||"#Game"!==location.hash||(t.returnValue="Ваш прогресс не будет сохранен. Вы уверены что хотите покинуть игру?",t.returnValue&&window.location.reload())})),window.addEventListener("popstate",(t=>{"#Play"!==location.hash||this.gameEnd||(confirm("Ваш прогресс не будет сохранен. Вы уверены что хотите покинуть игру?")?window.location.reload():location.hash="#Game")}))}createMusic(){let t={},e=new Audio;e.src=Ir,e.play(),e.loop=!0;let n=new Audio;return n.src=_r,t.main=e,t.shifted=n,t}}class Pr{constructor(){this.game=new wr,this.view=new br(this.game),this.frogController=new Er,this.ballController=new xr(this.game.totalBalls,this.frogController.model),this.view.createCanvas()}draw(){this.view.draw(),this.frogController.draw(),this.ballController.draw()}}const Ar=function(){function t(){let t=null,e=null,n=null;const i={main:dr,game:ur,rules:pr,records:fr,error:gr};this.init=function(i){t=i,e=t.querySelector("#menu"),n=t.querySelector("#content"),this.renderContent("main")},this.updateButtons=function(t){const n=e.querySelectorAll(".mainmenu__link"),i=`#${t}`;for(let t of n)i===t.getAttribute("href")?t.classList.add("active"):t.classList.remove("active")},this.renderContent=function(t){let e="default";t.length>0&&(e=t in i?t:"error"),window.document.title=i[e].title,n.innerHTML=i[e].render(`${e}-page`),this.updateButtons(i[e].id)},this.play=function(){let t,e,n=Date.now(),i=1e3/62,s=new Pr;requestAnimationFrame((function r(){requestAnimationFrame(r),t=Date.now(),e=t-n,e>i&&(n=t-e%i,s.draw())}))}}function e(){let t=null;this.init=function(e){t=e},this.updateState=function(e){t.renderContent(e)},this.startGame=function(){t.play()}}function n(){let t=null,e=null;this.init=function(n,i){t=n,e=i,window.addEventListener("hashchange",this.updateState),this.updateState(),this.addEventListeners()},this.updateState=function(){const t=location.hash.slice(1).toLowerCase();e.updateState(t)},this.addEventListeners=function(){document.addEventListener("click",(function(t){t.target&&"game"===t.target.id&&e.startGame()}))}}return{init:function(i){this.initBuildHtml(i),this.main();const s=new t,r=new e,o=new n;s.init(document.getElementById(i)),r.init(s),o.init(document.getElementById(i),r)},main:function(){console.log("Initializing the game")},initBuildHtml:function(t){const e=document.getElementById(t);e.className="app",e.innerHTML=`\n\t\t\t<header class="header">\n\t\t\t<img class="header-logo" src="${ir}" alt="Logo">\n\t\t</header>\n\t\t<main class="main">\n\t\t\t<nav class="main-menu" id="menu">\n\t\t\t\t<ul class="menu-list">\n\t\t\t\t\t<li><a class="menu-link" id="game" href="#game">Adventure</a></li>\n\t\t\t\t\t<li><a class="menu-link" href="#rules">How to play</a></li>\n\t\t\t\t\t<li><a class="menu-link" href="#records">Records</a></li>\n\t\t\t\t</ul>\n\t\t\t</nav>\n\t\t\t<div class="content" id="content"></div>\n\t\t</main>\n\t\t `}}}();document.addEventListener("DOMContentLoaded",Ar.init("app"));const Or=function(){function t(){let t=null,e=null,n=null,i=null,s=null;this.init=function(s){t=s,this.showLoginForm(),n=document.querySelector("#btnLogout"),i=s.querySelector("#login"),e=s.querySelector("#errorLoginMessage")},this.showLoginForm=function(){s='<div id="login" class="login">\n\t\t\t<form id="login-form" class="login-form">\n\t\t\t\t<div class="item">\n\t\t\t\t\t<label for="email">Email</label>\n\t\t\t\t\t<input id="email" class="input-login" name="email" type="email" autocomplete="on">\n\t\t\t\t</div>\n\t\t\t\t<div class="item">\n\t\t\t\t\t<label for="password">Password</label>\n\t\t\t\t\t<input id="password" class="input-login" name="password" type="password" autocomplete="off">\n\t\t\t\t</div>\n\t\t\t\t<div id="loginMessage" class="group">\n\t\t\t\t\t<div id="errorLoginMessage" class="errorlabel"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-btn">\n\t\t\t\t\t<button id="btnLogin" type="button">Log in</button>\n\t\t\t\t\t<button id="btnRegister" type="button" name="register">Sign up</bsutton>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>',t.innerHTML=s},this.loginSuccess=function(t){e.style.color="rgb(153, 153, 153)",e.textContent=`${t}, login successfull!`},this.loginError=function(t){e.style.color="rgb(255, 0, 0)",e.textContent=`Login unsuccessfull: ${t}`},this.registerSuccess=function(t){e.style.color="rgb(153, 153, 153)",e.textContent=`${t}, registration successfull! Please login.`},this.registerError=function(t){e.style.color="rgb(255, 0, 0)",e.textContent=`Registration unsuccessfull: ${t}`},this.showForm=function(){n.style.display="none",i.style.display="block",muteBtn.style.display="none",menuBtn.style.display="none",document.body.classList.remove("game-bgnd")},this.hideForm=function(){i.style.display="none"},this.logoutError=function(t){console.log("An error happened.")},this.updateUserMsg=function(){e.style.color="rgb(153, 153, 153)",e.textContent="Complete data entry..."}}function e(){let t=null;this.init=function(e){t=e},this.login=function(e,n){(function(t,e,n){return async function(t,e){return qi(gi(t),e)}(V(t),Li.credential(e,n)).catch((async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&Ki(t),e}))})(nr,e,n).then((e=>{const n=e.user.email.split("@").slice(0,1)[0];t.loginSuccess(n),setTimeout((()=>{t.hideForm(),Ar.init("app")}),750)})).catch((e=>{t.loginError(e.code)}))},this.register=function(e,n){(async function(t,e,n){const i=gi(t),s=_i(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Hi),r=await s.catch((e=>{throw"auth/password-does-not-meet-requirements"===e.code&&Ki(t),e})),o=await $i._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(o.user),o})(nr,e,n).then((e=>{const n=e.user.email.split("@").slice(0,1)[0];t.registerSuccess(n)})).catch((e=>{t.registerError(e.code)}))},this.updateUserMsg=function(){t.updateUserMsg()}}function n(){let t=null,e=null,n=null;this.init=function(n,i){t=i,e=n,this.addEventListeners()},this.addEventListeners=function(){e.addEventListener("click",(function(i){n=e.querySelector("#login-form"),i.target&&"btnLogin"===i.target.id&&(i.preventDefault(),i.stopPropagation(),t.login(e.querySelector("#email").value,e.querySelector("#password").value)),i.target&&"btnRegister"===i.target.id&&(i.preventDefault(),i.stopPropagation(),t.register(e.querySelector("#email").value,e.querySelector("#password").value))}))}}return{init:function(i){const s=new t,r=new e,o=new n;s.init(document.getElementById(i)),r.init(s),o.init(document.getElementById(i),r)}}}();Or.init("app")})()})();